"use strict";(self.webpackChunkreact_homepage=self.webpackChunkreact_homepage||[]).push([[392],{392:(e,t,a)=>{a.r(t),a.d(t,{CLICK_MINE:()=>A,CODE:()=>h,FLAG_CELL:()=>m,INCREMENT_TIMER:()=>_,NORMALIZE_CELL:()=>w,OPEN_CELL:()=>L,QUESTION_CELL:()=>b,START_GAME:()=>C,TableContext:()=>I,default:()=>O});var r=a(555),l=a(43),n=a(579);const c=e=>{switch(e){case h.NORMAL:case h.MINE:return{background:"#a0a0a0"};case h.CLICKED_MINE:case h.OPENED:return{background:"#e0e0e0"};case h.QUESTION_MINE:case h.QUESTION:return{background:"#fff59d"};case h.FLAG_MINE:case h.FLAG:return{background:"#ef9a9a"};default:return{background:"#e0e0e0"}}},s=e=>{switch(e){case h.NORMAL:return"";case h.MINE:return"X";case h.CLICKED_MINE:return"\ud391";case h.FLAG_MINE:case h.FLAG:return"!";case h.QUESTION_MINE:case h.QUESTION:return"?";default:return e||""}},o=(0,l.memo)(e=>{let{rowIndex:t,cellIndex:a}=e;const{tableData:r,dispatch:c,halted:s}=(0,l.useContext)(I),o=r[t][a],i=(0,l.useCallback)(()=>{if(!s)switch(o){case h.OPENED:case h.FLAG_MINE:case h.FLAG:case h.QUESTION_MINE:case h.QUESTION:return;case h.NORMAL:return void c({type:L,row:t,cell:a});case h.MINE:return void c({type:A,row:t,cell:a});default:return}},[s,o,c,t,a]),E=(0,l.useCallback)(e=>{if(e.preventDefault(),!s)switch(o){case h.NORMAL:case h.MINE:return void c({type:m,row:t,cell:a});case h.FLAG_MINE:case h.FLAG:return void c({type:b,row:t,cell:a});case h.QUESTION_MINE:case h.QUESTION:return void c({type:w,row:t,cell:a});default:return}},[s,o,c,t,a]);return(0,n.jsx)(u,{onClickTd:i,onRightClickTd:E,data:o})}),u=(0,l.memo)(e=>{let{onClickTd:t,onRightClickTd:a,data:r}=e;return(0,n.jsx)("td",{style:c(r),onClick:t,onContextMenu:a,children:s(r)})}),i=o,E=(0,l.memo)(e=>{let{rowIndex:t}=e;const{tableData:a}=(0,l.useContext)(I);return(0,n.jsx)("tr",{children:a[0]&&Array(a[0].length).fill().map((e,a)=>(0,n.jsx)(i,{rowIndex:t,cellIndex:a}))})}),d=(0,l.memo)(()=>{const{tableData:e}=(0,l.useContext)(I);return(0,n.jsx)("table",{children:Array(e.length).fill().map((e,t)=>(0,n.jsx)(E,{rowIndex:t}))})}),N=()=>{const[e,t]=(0,l.useState)(10),[a,r]=(0,l.useState)(10),[c,s]=(0,l.useState)(20),{dispatch:o}=(0,l.useContext)(I),u=(0,l.useCallback)(e=>{t(e.target.value)},[]),i=(0,l.useCallback)(e=>{r(e.target.value)},[]),E=(0,l.useCallback)(e=>{s(e.target.value)},[]),d=(0,l.useCallback)(()=>{o({type:C,row:e,cell:a,mine:c})},[o,e,a,c]);return(0,n.jsxs)("div",{className:"mine-search-form",children:[(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{htmlFor:"row-input",children:"\uc138\ub85c:"}),(0,n.jsx)("input",{id:"row-input",type:"number",value:e,onChange:u})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{htmlFor:"cell-input",children:"\uac00\ub85c:"}),(0,n.jsx)("input",{id:"cell-input",type:"number",value:a,onChange:i})]}),(0,n.jsxs)("div",{className:"input-group",children:[(0,n.jsx)("label",{htmlFor:"mine-input",children:"\uc9c0\ub8b0:"}),(0,n.jsx)("input",{id:"mine-input",type:"number",value:c,onChange:E})]}),(0,n.jsx)("button",{onClick:d,children:"\uc2dc\uc791"})]})},h={MINE:-7,NORMAL:-1,QUESTION:-2,FLAG:-3,QUESTION_MINE:-4,FLAG_MINE:-5,CLICKED_MINE:-6,OPENED:0},I=(0,l.createContext)({tableData:[],halted:!0,dispatch:()=>{}}),p={tableData:[],data:{row:0,cell:0,mine:0},timer:0,result:"",halted:!0,openedCount:0},M=(e,t,a)=>{const r=Array(e*t).fill().map((e,t)=>t),l=[];for(;r.length>e*t-a;){const e=r.splice(Math.floor(Math.random()*r.length),1)[0];l.push(e)}const n=[];for(let c=0;c<e;c++){const e=[];n.push(e);for(let a=0;a<t;a++)e.push(h.NORMAL)}for(let c=0;c<l.length;c++){const e=Math.floor(l[c]/t),a=l[c]%t;n[e][a]=h.MINE}return n},C="START_GAME",L="OPEN_CELL",A="CLICK_MINE",m="FLAG_CELL",b="QUESTION_CELL",w="NORMALIZE_CELL",_="INCREMENT_TIMER",x=(e,t)=>{switch(t.type){case C:return(0,r.A)((0,r.A)({},e),{},{data:{row:t.row,cell:t.cell,mine:t.mine},openedCount:0,tableData:M(t.row,t.cell,t.mine),halted:!1,timer:0,result:""});case L:{const a=[...e.tableData];a.forEach((e,t)=>{a[t]=[...e]});const l=[];let n=0;const c=(e,t)=>{if(e<0||e>=a.length||t<0||t>=a[0].length)return;if([h.OPENED,h.FLAG,h.FLAG_MINE,h.QUESTION_MINE,h.QUESTION].includes(a[e][t]))return;if(l.includes(e+"/"+t))return;l.push(e+"/"+t);let r=[a[e][t-1],a[e][t+1]];a[e-1]&&(r=r.concat([a[e-1][t-1],a[e-1][t],a[e-1][t+1]])),a[e+1]&&(r=r.concat([a[e+1][t-1],a[e+1][t],a[e+1][t+1]]));const s=r.filter(function(e){return[h.MINE,h.FLAG_MINE,h.QUESTION_MINE].includes(e)}).length;if(0===s){const r=[];e-1>-1&&(r.push([e-1,t-1]),r.push([e-1,t]),r.push([e-1,t+1])),r.push([e,t-1]),r.push([e,t+1]),e+1<a.length&&(r.push([e+1,t-1]),r.push([e+1,t]),r.push([e+1,t+1])),r.forEach(e=>{a[e[0]][e[1]]!==h.OPENED&&c(e[0],e[1])})}a[e][t]===h.NORMAL&&(n+=1),a[e][t]=s};c(t.row,t.cell);let s=!1,o="";return e.data.row*e.data.cell-e.data.mine===e.openedCount+n&&(s=!0,o="".concat(e.timer,"\ucd08\ub9cc\uc5d0 \uc2b9\ub9ac\ud558\uc168\uc2b5\ub2c8\ub2e4")),(0,r.A)((0,r.A)({},e),{},{tableData:a,openedCount:e.openedCount+n,halted:s,result:o})}case A:{const a=[...e.tableData];return a[t.row]=[...e.tableData[t.row]],a[t.row][t.cell]=h.CLICKED_MINE,(0,r.A)((0,r.A)({},e),{},{tableData:a,halted:!0})}case m:{const a=[...e.tableData];return a[t.row]=[...e.tableData[t.row]],a[t.row][t.cell]===h.MINE?a[t.row][t.cell]=h.FLAG_MINE:a[t.row][t.cell]=h.FLAG,(0,r.A)((0,r.A)({},e),{},{tableData:a})}case b:{const a=[...e.tableData];return a[t.row]=[...e.tableData[t.row]],a[t.row][t.cell]===h.FLAG_MINE?a[t.row][t.cell]=h.QUESTION_MINE:a[t.row][t.cell]=h.QUESTION,(0,r.A)((0,r.A)({},e),{},{tableData:a})}case w:{const a=[...e.tableData];return a[t.row]=[...e.tableData[t.row]],a[t.row][t.cell]===h.QUESTION_MINE?a[t.row][t.cell]=h.MINE:a[t.row][t.cell]=h.NORMAL,(0,r.A)((0,r.A)({},e),{},{tableData:a})}case _:return(0,r.A)((0,r.A)({},e),{},{timer:e.timer+1});default:return e}},O=()=>{const[e,t]=(0,l.useReducer)(x,p),{tableData:a,halted:r,timer:c,result:s}=e,o=(0,l.useMemo)(()=>({tableData:a,halted:r,dispatch:t}),[a,r]);return(0,l.useEffect)(()=>{let e;return!1===r&&(e=setInterval(()=>{t({type:_})},1e3)),()=>{clearInterval(e)}},[r]),(0,n.jsx)(I.Provider,{value:o,children:(0,n.jsxs)("div",{className:"mine-search-container",children:[(0,n.jsx)(N,{}),(0,n.jsx)("div",{className:"mine-search-timer",children:c}),(0,n.jsx)(d,{}),(0,n.jsx)("div",{className:"mine-search-result",children:s})]})})}}}]);
//# sourceMappingURL=392.965f7f15.chunk.js.map